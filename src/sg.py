import xfab
from xfab import sglib
import numpy as n

class sg:
	def __init__(self,sgno = None, sgname = None):
		if sgno != None:
			klass_name = "".join('sg%i' %sgno)
		elif sgname != None:
			klass_name = sgdic[sgname]
		if hasattr(xfab, 'sglib'):
			module = getattr(xfab, 'sglib')
			if hasattr(module, klass_name):
				klass  = getattr(module, klass_name)
			else:
				raise Exception("No " + klass_name + " class in sglib")
		else:
			raise Exception("sglib module cannot be reached")
	
		obj = klass()

		self.name = obj.name
		self.no = obj.no
		self.nsymop = obj.nsymop
		self.nuniq = obj.nuniq
		self.syscond = n.array(obj.syscond)
		self.rot = n.array(obj.rot)
		self.trans = n.array(obj.trans)


sgdic = {
         "P1" : "sg1",
         "P-1" : "sg2",
         "P2" : "sg3",
         "P21" : "sg4",
         "C2" : "sg5",
         "Pm" : "sg6",
         "Pc" : "sg7",
         "Cm" : "sg8",
         "Cc" : "sg9",
         "P2/m" : "sg10",
         "P21/m" : "sg11",
         "C2/m" : "sg12",
         "P2/c" : "sg13",
         "P21/c" : "sg14",
         "C2/c" : "sg15",
         "P222" : "sg16",
         "P2221" : "sg17",
         "P21212" : "sg18",
         "P212121" : "sg19",
         "C2221" : "sg20",
         "C222" : "sg21",
         "F222" : "sg22",
         "I222" : "sg23",
         "I212121" : "sg24",
         "Pmm2" : "sg25",
         "Pmc21" : "sg26",
         "Pcc2" : "sg27",
         "Pma2" : "sg28",
         "Pca21" : "sg29",
         "Pnc2" : "sg30",
         "Pmn21" : "sg31",
         "Pba2" : "sg32",
         "Pna21" : "sg33",
         "Pnn2" : "sg34",
         "Cmm2" : "sg35",
         "Cmc21" : "sg36",
         "Ccc2" : "sg37",
         "Amm2" : "sg38",
         "Abm2" : "sg39",
         "Ama2" : "sg40",
         "Aba2" : "sg41",
         "Fmm2" : "sg42",
         "Fdd2" : "sg43",
         "Imm2" : "sg44",
         "Iba2" : "sg45",
         "Ima2" : "sg46",
         "Pmmm" : "sg47",
         "Pnnn" : "sg48",
         "Pccm" : "sg49",
         "Pban" : "sg50",
         "Pmma" : "sg51",
         "Pnna" : "sg52",
         "Pmna" : "sg53",
         "Pcca" : "sg54",
         "Pbam" : "sg55",
         "Pccn" : "sg56",
         "Pbcm" : "sg57",
         "Pnnm" : "sg58",
         "Pmmn" : "sg59",
         "Pbcn" : "sg60",
         "Pbca" : "sg61",
         "Pnma" : "sg62",
         "Cmcm" : "sg63",
         "Cmca" : "sg64",
         "Cmmm" : "sg65",
         "Cccm" : "sg66",
         "Cmma" : "sg67",
         "Ccca" : "sg68",
         "Fmmm" : "sg69",
         "Fddd" : "sg70",
         "Immm" : "sg71",
         "Ibam" : "sg72",
         "Ibca" : "sg73",
         "Imma" : "sg74",
         "P4" : "sg75",
         "P41" : "sg76",
         "P42" : "sg77",
         "P43" : "sg78",
         "I4" : "sg79",
         "I41" : "sg80",
         "P-4" : "sg81",
         "I-4" : "sg82",
         "P4/m" : "sg83",
         "P42/m" : "sg84",
         "P4/n" : "sg85",
         "P42/n" : "sg86",
         "I4/m" : "sg87",
         "I41/a" : "sg88",
         "P422" : "sg89",
         "P4212" : "sg90",
         "P4122" : "sg91",
         "P41212" : "sg92",
         "P4222" : "sg93",
         "P42212" : "sg94",
         "P4322" : "sg95",
         "P43212" : "sg96",
         "I422" : "sg97",
         "I4122" : "sg98",
         "P4mm" : "sg99",
         "P4bm" : "sg100",
         "P42cm" : "sg101",
         "P42nm" : "sg102",
         "P4cc" : "sg103",
         "P4nc" : "sg104",
         "P42mc" : "sg105",
         "P42bc" : "sg106",
         "I4mm" : "sg107",
         "I4cm" : "sg108",
         "I41md" : "sg109",
         "I41cd" : "sg110",
         "P-42m" : "sg111",
         "P-42c" : "sg112",
         "P-421m" : "sg113",
         "P-421c" : "sg114",
         "P-4m2" : "sg115",
         "P-4c2" : "sg116",
         "P-4b2" : "sg117",
         "P-4n2" : "sg118",
         "I-4m2" : "sg119",
         "I-4c2" : "sg120",
         "I-42m" : "sg121",
         "I-42d" : "sg122",
         "P4/mmm" : "sg123",
         "P4/mcc" : "sg124",
         "P4/nbm" : "sg125",
         "P4/nnc" : "sg126",
         "P4/mbm" : "sg127",
         "P4/mnc" : "sg128",
         "P4/nmm" : "sg129",
         "P4/ncc" : "sg130",
         "P42/mmc" : "sg131",
         "P42/mcm" : "sg132",
         "P42/nbc" : "sg133",
         "P42/nnm" : "sg134",
         "P42/mbc" : "sg135",
         "P42/mnm" : "sg136",
         "P42/nmc" : "sg137",
         "P42/ncm" : "sg138",
         "I4/mmm" : "sg139",
         "I4/mcm" : "sg140",
         "I41/amd" : "sg141",
         "I41/acd" : "sg142",
         "P3" : "sg143",
         "P31" : "sg144",
         "P32" : "sg145",
         "R3" : "sg146",
         "P-3" : "sg147",
         "R-3" : "sg148",
         "P312" : "sg149",
         "P321" : "sg150",
         "P3112" : "sg151",
         "P3121" : "sg152",
         "P3212" : "sg153",
         "P3221" : "sg154",
         "R32" : "sg155",
         "P3m1" : "sg156",
         "P31m" : "sg157",
         "P3c1" : "sg158",
         "P31c" : "sg159",
         "R3m" : "sg160",
         "R3c" : "sg161",
         "P-31m" : "sg162",
         "P-31c" : "sg163",
         "P-3m1" : "sg164",
         "P-3c1" : "sg165",
         "R-3m" : "sg166",
         "R-3c" : "sg167",
         "P6" : "sg168",
         "P61" : "sg169",
         "P65" : "sg170",
         "P62" : "sg171",
         "P64" : "sg172",
         "P63" : "sg173",
         "P-6" : "sg174",
         "P6/m" : "sg175",
         "P63/m" : "sg176",
         "P622" : "sg177",
         "P6122" : "sg178",
         "P6522" : "sg179",
         "P6222" : "sg180",
         "P6422" : "sg181",
         "P6322" : "sg182",
         "P6mm" : "sg183",
         "P6cc" : "sg184",
         "P63cm" : "sg185",
         "P63mc" : "sg186",
         "P-6m2" : "sg187",
         "P-6c2" : "sg188",
         "P-62m" : "sg189",
         "P-62c" : "sg190",
         "P6/mmm" : "sg191",
         "P6/mcc" : "sg192",
         "P63/mcm" : "sg193",
         "P63/mmc" : "sg194",
         "P23" : "sg195",
         "F23" : "sg196",
         "I23" : "sg197",
         "P213" : "sg198",
         "I213" : "sg199",
         "Pm-3" : "sg200",
         "Pn-3" : "sg201",
         "Fm-3" : "sg202",
         "Fd-3" : "sg203",
         "Im-3" : "sg204",
         "Pa-3" : "sg205",
         "Ia-3" : "sg206",
         "P432" : "sg207",
         "P4232" : "sg208",
         "F432" : "sg209",
         "F4132" : "sg210",
         "I432" : "sg211",
         "P4332" : "sg212",
         "P4132" : "sg213",
         "I4132" : "sg214",
         "P-43m" : "sg215",
         "F-43m" : "sg216",
         "I-43m" : "sg217",
         "P-43n" : "sg218",
         "F-43c" : "sg219",
         "I-43d" : "sg220",
         "Pm-3m" : "sg221",
         "Pn-3n" : "sg222",
         "Pm-3n" : "sg223",
         "Pn-3m" : "sg224",
         "Fm-3m" : "sg225",
         "Fm-3c" : "sg226",
         "Fd-3m" : "sg227",
         "Fd-3c" : "sg228",
         "Im-3m" : "sg229",
         "Ia-3d" : "sg230",
        }
